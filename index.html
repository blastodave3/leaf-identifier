<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tree Leaf Identifier</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.4/p5.min.js"></script>
    <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
    <style>
        body { font-family: sans-serif; text-align: center; background: #222; color: white; }
        canvas { border-radius: 10px; margin-top: 20px; }
    </style>
</head>
<body>
    <h2>Tree Leaf Identifier</h2>
    <div id="canvas-container"></div>

    <script>
        // --- 1. SETTINGS ---
        // REPLACE THIS with your own model link from Teachable Machine!
       let imageModelURL = 'https://teachablemachine.withgoogle.com/models/7ZyhWuPe7/';
        
        let classifier;
        let video;
        let flippedVideo;
        let label = "Loading model...";

        // --- 2. PRELOAD ---
        function preload() {
            // Load the model before the sketch starts
            classifier = ml5.imageClassifier(imageModelURL + 'model.json');
        }

        // --- 3. SETUP (Your Code) ---
        function setup() {
    let canvas = createCanvas(320, 260);
    canvas.parent('canvas-container');
    
    // Updated video constraints for mobile stability
    let constraints = {
        video: {
            facingMode: { ideal: "environment" } // Forces back camera
        },
        audio: false
    };

    video = createCapture(constraints, function(stream) {
        console.log("Camera is ready!");
    });
    
    video.size(320, 240);
    video.hide();

    flippedVideo = ml5.flipImage(video);
    classifyVideo();
}
4. iOS (Safari) Specific Issue
If you are on an iPhone, Safari has a "feature" that pauses video if it's not being "played" correctly. In your draw() function, add this one line at the very top:

JavaScript

function draw() {
    if (video) video.play(); // Forces the camera stream to keep running
    background(0);
    // ... rest of your code
5. Check the Console for Errors
If it still won't come up, we need to see the "hidden" error messages.

Open your site on a desktop computer.

Right-click anywhere and select Inspect.

Click the Console tab.

If you see red text saying PermissionDeniedError or Could not start video source, it means the browser is still blocking the camera.

Would you like me to rewrite the full index.html with these mobile-stability fixes included so you can just copy-paste it again?

        // --- 4. DRAW (Your Code) ---
        function draw() {
            background(0);
            image(flippedVideo, 0, 0);

            fill(255);
            textSize(16);
            textAlign(CENTER);
            text(label, width / 2, height - 10);
        }

        // --- 5. CLASSIFY (Your Code) ---
        function classifyVideo() {
            flippedVideo = ml5.flipImage(video);
            classifier.classify(flippedVideo, gotResult);
        }

        // --- 6. RESULTS (Your Code) ---
        function gotResult(error, results) {
            if (error) {
                console.error(error);
                return;
            }
            label = results[0].label;
            classifyVideo();
        }
    </script>
</body>
</html>

 
